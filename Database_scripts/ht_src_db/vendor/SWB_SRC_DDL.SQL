CREATE OR REPLACE TABLE SWB_ACCOUNT_IMP (
	RECORD_TYPE VARCHAR(2),
	CUSTODIAN_ID VARCHAR(8),
	MASTER_ACCOUNT_NUMBER VARCHAR(10),
	MASTER_ACCOUNT_NAME VARCHAR(30),
	BUSINESS_DATE VARCHAR(8),
	ACCOUNT_ID VARCHAR(10),
	ACCOUNT_TITLE_LINE_1 VARCHAR(45),
	ACCOUNT_TITLE_LINE_2 VARCHAR(45),
	ACCOUNT_TITLE_LINE_3 VARCHAR(45),
	ACCOUNT_STATUS VARCHAR(8),
	ACCOUNT_REGISTRATION VARCHAR(5),
	ACCOUNT_TYPE VARCHAR(5),
	TAXPAYER_TITLE VARCHAR(5),
	TAXPAYER_FIRST_NAME VARCHAR(30),
	TAXPAYER_MIDDLE_NAME VARCHAR(30),
	TAXPAYER_LAST_NAME VARCHAR(30),
	TAXPAYER_SUFFIX VARCHAR(5),
	TAX_WITHHOLD_CODE VARCHAR(2),
	PRIMARY_CONTACT VARCHAR(104),
	ALIAS_NAME VARCHAR(62),
	MAILING_ADDRESS_LINE_1 VARCHAR(45),
	MAILING_ADDRESS_LINE_2 VARCHAR(45),
	MAILING_ADDRESS_LINE_3 VARCHAR(45),
	ACCOUNT_MAILING_CITY VARCHAR(30),
	ACCOUNT_MAILING_STATE VARCHAR(2),
	ACCOUNT_MAILING_ZIP VARCHAR(10),
	ACCOUNT_MAILING_COUNTRY_CODE VARCHAR(22),
	EMAIL_ADDRESS VARCHAR(128),
	PHONE VARCHAR(12),
	BUSINESS_PHONE VARCHAR(12),
	DATE_OPENED VARCHAR(8),
	SCHWAB_BRANCH_CODE VARCHAR(8),
	SWEEP_STATUS_CODE VARCHAR(1),
	CASH_ACCOUNT_CODE VARCHAR(2),
	MARGIN_ACCOUNT_CODE VARCHAR(2),
	MARGIN_ACCOUNT_FLAG VARCHAR(1),
	ACCOUNT_RESTRICTIONS VARCHAR(1),
	ADDITIONAL_MAILINGS_FLAG VARCHAR(1),
	NUMBER_OF_ADDITIONAL_MAILINGS VARCHAR(2),
	APPROVED_OPTION_LEVEL VARCHAR(1),
	BENEFICIARY_ON_FILE_FLAG VARCHAR(1),
	NUMBER_OF_BENEFICIARIES VARCHAR(2),
	CHECKS_ISSUED_FLAG VARCHAR(1),
	DEBIT_CARD_ISSUED_FLAG VARCHAR(1),
	BILLPAY_ACTIVATED_FLAG VARCHAR(1),
	UNDELIVERED_MAIL_FLAG VARCHAR(1),
	FA_FEE_STATUS VARCHAR(1),
	INTEREST_BEARING_FEATURE_CODE VARCHAR(5),
	INTEREST_BEARING_MONEY_MARKET_CODE VARCHAR(5),
	INTEREST_BEARING_TICKER_SYMBOL VARCHAR(30),
	INTEREST_BEARING_ITEM_ISSUE_ID VARCHAR(10),
	INTEREST_BEARING_RULE_SET_SUFFIX VARCHAR(5),
	PROXY_VOTING_AUTHORITY VARCHAR(1),
	PROXY_MAILING VARCHAR(1),
	STATEMENT_PREFERENCES VARCHAR(8),
	ACCOUNT_TAXABLE_FLAG VARCHAR(1),
	DEFAULT_LOT_SELECTION_METHOD VARCHAR(5),
	COST_METHOD VARCHAR(1),
	COST_BASIS_METHOD_MUTUAL_FUNDS VARCHAR(5),
	COST_BASIS_METHOD_NON_MUTUAL_FUNDS VARCHAR(5),
	COST_BASIS_METHOD_DATE VARCHAR(8),
	VERSION_MARKER_NUMBER_1 VARCHAR(8),
	CUSTOMER_TYPE_CODE VARCHAR(8),
	ORGANIZATION_PRIMARY_NAME VARCHAR(60),
	VERSION_MARKER_NUMBER_2 VARCHAR(8),
	RESTRICTION_REASON_CODE_1 VARCHAR(4),
	RESTRICTION_REASON_CODE_2 VARCHAR(4),
	RESTRICTION_REASON_CODE_3 VARCHAR(4),
	RESTRICTION_REASON_CODE_4 VARCHAR(4),
	RESTRICTION_REASON_CODE_5 VARCHAR(4),
	VERSION_MARKER_NUMBER_3 VARCHAR(8),
	SCHWAB_BANK_INVESTOR_CHECKING_ACCOUNT_NUMBER VARCHAR(12),
	VERSION_MARKER_NUMBER_4 VARCHAR(8),
	SSN_TAXID_NUMBER VARCHAR(11),
	VERSION_MARKER_NUMBER_5 VARCHAR(8),
	PRIME_BROKER_ENABLED_INDICATOR VARCHAR(1),
	MANAGED_ACCOUNT_PLATFORM_CODE VARCHAR(8),
	MANAGED_ACCOUNT_MONEY_MANAGER VARCHAR(100),
	MANAGED_ACCOUNT_INVESTMENT_STRATEGY VARCHAR(50),
	VERSION_MARKER_NUMBER_6 VARCHAR(8),
	BANK_SWEEP_DISPLAY_NAME VARCHAR(50),
	VERSION_MARKER_NUMBER_7 VARCHAR(8),
	OL VARCHAR(1),
	RUN_ID NUMBER(11,0)
);

CREATE OR REPLACE TABLE SWB_POSITION_IMP (
	RECORD_TYPE VARCHAR(2),
	CUSTODIAN_CODE VARCHAR(8),
	MASTER_ACCOUNT_NUMBER VARCHAR(10),
	MASTER_ACCOUNT_NAME VARCHAR(30),
	BUSINESS_DATE VARCHAR(8),
	ACCOUNT_ID VARCHAR(10),
	PRODUCT_CODE VARCHAR(4),
	PRODUCT_CATEGORY_CODE VARCHAR(4),
	TAX_CODE VARCHAR(8),
	LEGACY_SECURITY_TYPE VARCHAR(2),
	TICKER_SYMBOL VARCHAR(30),
	INDUSTRY_TICKER_SYMBOL VARCHAR(30),
	CUSIP VARCHAR(10),
	SCHWAB_SECURITY_NUMBER VARCHAR(7),
	ITEM_ISSUE_ID VARCHAR(10),
	RULE_SET_SUFFIX_ID NUMBER(11,0),
	ISIN VARCHAR(12),
	SEDOL VARCHAR(7),
	OPTIONS_DISPLAY_SYMBOL VARCHAR(30),
	SECURITY_DESCRIPTION_LINE_1 VARCHAR(24),
	SECURITY_DESCRIPTION_LINE_2 VARCHAR(24),
	SECURITY_DESCRIPTION_LINE_3 VARCHAR(24),
	SECURITY_DESCRIPTION_LINE_4 VARCHAR(24),
	UNDERLYING_TICKER_SYMBOL VARCHAR(30),
	UNDERLYING_INDUSTRY_TICKER_SYMBOL VARCHAR(30),
	UNDERLYING_CUSIP VARCHAR(9),
	UNDERLYING_SCHWAB_SECURITY_NUMBER VARCHAR(7),
	UNDERLYING_ITEM_ISSUE_ID VARCHAR(10),
	UNDERLYING_RULE_SET_SUFFIX_ID VARCHAR(5),
	UNDERLYING_ISIN VARCHAR(12),
	UNDERLYING_SEDOL VARCHAR(7),
	MONEY_MARKET_CODE VARCHAR(5),
	DIVIDEND_REINVEST VARCHAR(1),
	CAPITAL_GAINS_REINVEST VARCHAR(1),
	CLOSING_PRICE NUMBER(17,5),
	SECURITY_PRICE_UPDATE_DATE VARCHAR(8),
	QUANTITY NUMBER(15,5),
	LONG_SHORT_INDICATOR VARCHAR(1),
	MARKET_VALUE_SETTLED_AND_UNSETTLED NUMBER(14,4),
	ACCOUNTING_RULE_CODE VARCHAR(11),
	QUANTITY_SETTLED NUMBER(15,5),
	QUANTITY_UNSETTLED_LONG NUMBER(15,5),
	QUANTITY_UNSETTLED_SHORT NUMBER(15,5),
	VERSION_MARKER_NUMBER_1 VARCHAR(8),
	TIPS_FACTOR NUMBER(18,9),
	ASSET_BACKED_FACTOR NUMBER(15,1),
	VERSION_MARKER_NUMBER_2 VARCHAR(8),
	CLOSING_PRICE_UNFACTORED NUMBER(15,5),
	FACTOR NUMBER(15,1),
	FACTOR_DATE VARCHAR(8),
	RUN_ID NUMBER(11,0)
);

CREATE OR REPLACE TABLE SWB_TRANSACTION_IMP (
	RECORD_TYPE VARCHAR(2),
	CUSTODIAN_ID VARCHAR(8),
	MASTER_ACCOUNT_NUMBER VARCHAR(10),
	MASTER_ACCOUNT_NAME VARCHAR(30),
	BUSINESS_DATE VARCHAR(8),
	ACCOUNT_ID VARCHAR(10),
	ACCOUNT_TITLE_LINE_1 VARCHAR(45),
	ACCOUNT_TITLE_LINE_2 VARCHAR(45),
	ACCOUNT_TITLE_LINE_3 VARCHAR(45),
	ACCOUNT_REGISTRATION VARCHAR(5),
	ACCOUNT_TYPE VARCHAR(5),
	PRODUCT_CODE VARCHAR(4),
	PRODUCT_CATEGORY_CODE VARCHAR(5),
	TAX_CODE VARCHAR(8),
	LEGACY_SECURITY_TYPE VARCHAR(2),
	TICKER_SYMBOL VARCHAR(30),
	INDUSTRY_TICKER_SYMBOL VARCHAR(30),
	CUSIP VARCHAR(9),
	SCHWAB_SECURITY_NUMBER VARCHAR(7),
	ITEM_ISSUE_ID VARCHAR(10),
	RULE_SET_SUFFIX_ID VARCHAR(5),
	ISIN VARCHAR(12),
	SEDOL VARCHAR(7),
	OPTIONS_DISPLAY_SYMBOL VARCHAR(30),
	UNDERLYING_TICKER_SYMBOL VARCHAR(30),
	UNDERLYING_INDUSTRY_TICKER_SYMBOL VARCHAR(30),
	UNDERLYING_CUSIP VARCHAR(9),
	UNDERLYING_SCHWAB_SECURITY_NUMBER VARCHAR(7),
	UNDERLYING_ITEM_ISSUE_ID VARCHAR(10),
	UNDERLYING_RULE_SET_SUFFIX_ID VARCHAR(5),
	UNDERLYING_ISIN VARCHAR(12),
	UNDERLYING_SEDOL VARCHAR(7),
	MONEY_MARKET_CODE VARCHAR(5),
	TRANSACTION_TYPE_CODE VARCHAR(2),
	TRANSACTION_SUBTYPE_CODE VARCHAR(2),
	TRANSACTION_CATEGORY VARCHAR(24),
	TRANSACTION_SOURCE_CODE VARCHAR(5),
	TRANSACTION_SOURCE_CODE_DESCRIPTION VARCHAR(18),
	TRANSACTION_DETAIL_DESCRIPTION VARCHAR(80),
	ACTION_CODE VARCHAR(6),
	TRANSACTION_CANCEL_CODE VARCHAR(1),
	TRADE_DATE VARCHAR(8),
	SETTLEMENT_DATE VARCHAR(8),
	TRANSACTION_DATE VARCHAR(8),
	EX_DIVIDEND_DATE VARCHAR(8),
	QUANTITY NUMBER(15,5),
	PRICE NUMBER(15,5),
	GROSS_AMOUNT NUMBER(15,2),
	DEBIT_CREDIT_INDICATOR VARCHAR(6),
	NET_AMOUNT NUMBER(15,2),
	COMMISSION NUMBER(15,2),
	EXCHANGE_PROCESSING_FEE NUMBER(15,2),
	BROKER_SERVICE_FEE NUMBER(15,2),
	PRIME_BROKER_FEE NUMBER(15,2),
	TRADE_AWAY_FEE NUMBER(15,2),
	REDEMPTION_FEE NUMBER(15,2),
	OTHER_FEE NUMBER(15,2),
	FEDERAL_TEFRA_WITHHOLDING NUMBER(15,2),
	STATE_TAX_WITHHOLDING NUMBER(15,2),
	STATE_RECEIVING_TAX VARCHAR(2),
	ACCRUED_INTEREST NUMBER(15,2),
	ACCOUNTING_RULE_CODE VARCHAR(12),
	ORDER_SOURCE_CODE VARCHAR(4),
	ORDER_NUMBER VARCHAR(8),
	TRADE_ORDER_ENTRY_TIME_STAMP VARCHAR(14),
	TRADE_ORDER_EXECUTION_TIME_STAMP VARCHAR(14),
	BROKER_CODE VARCHAR(8),
	BROKER_NAME VARCHAR(50),
	SCHWAB_FROM_ACCOUNT VARCHAR(10),
	SCHWAB_TO_ACCOUNT VARCHAR(10),
	SCHWAB1_CHECK_NUMBER VARCHAR(15),
	SWEEP_INDICATOR VARCHAR(1),
	STOCK_EXCHANGE_CODE VARCHAR(5),
	INTER_CLASS_EXCHANGE_CODE VARCHAR(1),
	DISTRIBUTION_RATE NUMBER(16,8),
	CASH_IN_LIEU_SHARE_QUANTITY NUMBER(16,8),
	DIVIDEND_INTEREST_SHARE_QUANTITY NUMBER(16,8),
	CASH_IN_LIEU_RATE NUMBER(16,8),
	ASSET_BACKED_FACTOR NUMBER(16,1),
	SOURCE_SYSTEM VARCHAR(2),
	JOURNAL_TYPE VARCHAR(2),
	DEPOSIT_MEDIA VARCHAR(1),
	SCHWAB_CASHIERING_UNIQUE_IDENTIFIER VARCHAR(23),
	RECIPIENT_MAKER_NAME_LINE_1 VARCHAR(60),
	RECIPIENT_MAKER_NAME_LINE_2 VARCHAR(60),
	RECIPIENT_MAKER_NAME_LINE_3 VARCHAR(60),
	FREQUENCY VARCHAR(12),
	DISBURSED_CHECK_NUMBER VARCHAR(15),
	FED_REFERENCE_NUMBER VARCHAR(35),
	RECIPIENT_MAKER_ACCOUNT_NUMBER VARCHAR(35),
	BANK_ACCOUNT_TYPE VARCHAR(8),
	BANK_NAME_PART_1 VARCHAR(60),
	BANK_NAME_PART_2 VARCHAR(60),
	BANK_ABA_NUMBER VARCHAR(9),
	INTERMEDIARY_NAME VARCHAR(60),
	TRANSACTION_CHECK_MEMO_1 VARCHAR(50),
	TRANSACTION_CHECK_MEMO_2 VARCHAR(50),
	RETIREMENT_FEDERAL_INCOME_TAX NUMBER(17,2),
	RETIREMENT_STATE_INCOME_TAX NUMBER(17,2),
	RETIREMENT_INCOME_TAX_STATE VARCHAR(2),
	PUBLICATION_TIME_STAMP VARCHAR(26),
	VERSION_MARKER_1 VARCHAR(8),
	TIPS_FACTOR NUMBER(16,8),
	CLOSING_PRICE NUMBER(16,4),
	VERSION_MARKER_2 VARCHAR(8),
	FUTURE_USE_1 VARCHAR(240),
	VERSION_MARKER_3 VARCHAR(8),
	CLOSING_PRICE_UNFACTORED NUMBER(16,4),
	FACTOR NUMBER(16,1),
	FACTOR_DATE VARCHAR(8),
	RUN_ID NUMBER(11,0)
);

CREATE OR REPLACE TABLE SWB_SECURITY_IMP (
	RECORD_TYPE VARCHAR(2),
	CUSTODIAN_ID VARCHAR(8),
	MASTER_ACCOUNT_NUMBER VARCHAR(10),
	MASTER_ACCOUNT_NAME VARCHAR(30),
	BUSINESS_DATE VARCHAR(8),
	PRODUCT_CODE VARCHAR(4),
	PRODUCT_CATEGORY_CODE VARCHAR(8),
	TAX_CODE VARCHAR(8),
	LEGACY_SECURITY_TYPE VARCHAR(2),
	TICKER_SYMBOL VARCHAR(30),
	INDUSTRY_TICKER_SYMBOL VARCHAR(30),
	CUSIP VARCHAR(9),
	SCHWAB_SECURITY_NUMBER VARCHAR(7),
	REORG_SECURITY_NUMBER VARCHAR(7),
	ITEM_ISSUE_ID VARCHAR(10),
	RULE_SET_SUFFIX_ID NUMBER(11,0),
	ISIN VARCHAR(12),
	SEDOL VARCHAR(7),
	OPTIONS_DISPLAY_SYMBOL VARCHAR(30),
	SECURITY_DESCRIPTION_LINE_1 VARCHAR(24),
	SECURITY_DESCRIPTION_LINE_2 VARCHAR(24),
	SECURITY_DESCRIPTION_LINE_3 VARCHAR(24),
	SECURITY_DESCRIPTION_LINE_4 VARCHAR(24),
	UNDERLYING_TICKER_SYMBOL VARCHAR(30),
	UNDERLYING_INDUSTRY_TICKER_SYMBOL VARCHAR(30),
	UNDERLYNG_CUSIP VARCHAR(9),
	UNDERLY_SCHWAB_SECURITY_NUMBER VARCHAR(7),
	UNDERLYING_ITEM_ISSUE_ID VARCHAR(10),
	UNDERLYING_RULE_SET_SUFFIX_ID VARCHAR(5),
	UNDERLYING_ISIN VARCHAR(12),
	UNDERLY_SEDOL VARCHAR(7),
	MONEY_MARKET_CODE VARCHAR(5),
	LAST_UPDATE_DATE VARCHAR(8),
	SWEEP_FUND_INDICATOR VARCHAR(1),
	CLOSING_PRICE NUMBER(17,5),
	SECURITY_PRICE_UPDATE_DATE VARCHAR(8),
	SECURITY_VALUATION_UNIT NUMBER(15,5),
	OPTION_ROOT_SYMBOL VARCHAR(15),
	OPTION_EXPIRATION_DATE VARCHAR(8),
	OPTION_CALL_OR_PUT_CODE VARCHAR(1),
	STRIKE_PRICE_AMOUNT NUMBER(15,5),
	INTEREST_RATE NUMBER(7,5),
	MATURITY_DATE VARCHAR(8),
	TIPS_FACTOR NUMBER(18,9),
	ASSET_BACKED_FACTOR NUMBER(15,12),
	FACE_VALUE_AMOUNT NUMBER(14,4),
	ISSUER_STATE VARCHAR(2),
	VERSION_MARKER_NUMBER_1 VARCHAR(8),
	SCHWAB_PROPRIETARY_INDICATOR VARCHAR(1),
	SCHWAB_ONE_SOURCE_INDICATOR VARCHAR(1),
	VERSION_MARKER_NUMBER_2 VARCHAR(8),
	CLOSING_PRICE_UNFACTORED NUMBER(15,5),
	FACTOR NUMBER(15,12),
	FACTOR_DATE VARCHAR(8),
	RUN_ID NUMBER(11,0)
);

CREATE OR REPLACE FILE FORMAT SWB_SOURCE_FILEFORMAT TYPE=CSV FIELD_DELIMITER = '|'
                  ERROR_ON_COLUMN_COUNT_MISMATCH = FALSE;

CREATE OR REPLACE STAGE SWB_SOURCE
        FILE_FORMAT = (FORMAT_NAME= 'SWB_SOURCE_FILEFORMAT')
        COPY_OPTIONS = (ON_ERROR  = CONTINUE);  